[{"path":"http://kwstat.github.io/gge/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2023 gge authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"http://kwstat.github.io/gge/articles/gge_examples.html","id":"abstract","dir":"Articles","previous_headings":"","what":"Abstract","title":"Genotype plus Genotype-By-Block-of-Environments Biplots","text":"short note GGE GGB biplots.","code":""},{"path":"http://kwstat.github.io/gge/articles/gge_examples.html","id":"r-setup","dir":"Articles","previous_headings":"","what":"R setup","title":"Genotype plus Genotype-By-Block-of-Environments Biplots","text":"example GGE (genotype plus genotype--environment) biplot similar figure 12 Yan Tinker (2006). flip argument can used flip x y axes biplots oriented desired. SVD factorization unique,  Many people prefer use ‘standardized’ biplots, data environment centered scaled. standardized biplots, unit circle drawn. Environment vectors reach unit circle perfectly represented two dimensional plane.  seen , environment vectors fairly long, relative performance genotypes environments can assessed reasonable accuracy. contrast, biplot based principal components 2 3 shorter vectors interpreted.  Laffont, Hanafi, Wright (2007) showed partition sums--squares simultaneously along principal component axes along ‘G’ ‘GxE’ axes.  mosaic plot shows first principal component axis capturing almost variation genotypes, projection genotype markers onto first principal component axis good overall representation rankings genotypes. Laffont, Wright, Hanafi (2013) presented GGB (genotype plus genotype--block environments) biplots, useful enhance view mega-environments consisting multiple locations.","code":"library(\"knitr\") knitr::opts_chunk$set(fig.align=\"center\", fig.width=6, fig.height=6) options(width=90) library(agridat) data(yan.winterwheat) dat1 <- yan.winterwheat  library(gge) m1 <- gge(dat1, yield~gen*env, scale=FALSE) biplot(m1, main=\"yan.winterwheat - GGE biplot\",        flip=c(1,0), origin=0, hull=TRUE) m2 <- gge(dat1, yield~gen*env, scale=TRUE) biplot(m2, main=\"yan.winterwheat - GGE biplot\",        flip=c(1,1), origin=0) biplot(m2, main=\"yan.winterwheat - GGE biplot - PC 2 & 3\",        comps=c(2,3), flip=c(1,1), origin=0) plot(m1, main=\"yan.winterwheat\") library(agridat) data(crossa.wheat) dat2 <- crossa.wheat  # Define mega-environment groups of locations dat2$eg <- ifelse(is.element(dat2$loc,                              c(\"KN\",\"NB\",\"PA\",\"BJ\",\"IL\",\"TC\",                                \"JM\",\"PI\",\"AS\",\"ID\",\"SC\",\"SS\",                                \"SJ\",\"MS\",\"MG\",\"MM\")), \"Grp1\", \"Grp2\")  library(gge) # Specify env.group as column in data frame m3 <- gge(dat2, yield~gen*loc, env.group=eg, scale=FALSE) biplot(m3, main=\"crossa.wheat - GGB biplot\")"},{"path":"http://kwstat.github.io/gge/articles/gge_examples.html","id":"how-to-modify-the-focus-of-a-biplot","dir":"Articles","previous_headings":"","what":"How to modify the “focus” of a biplot","title":"Genotype plus Genotype-By-Block-of-Environments Biplots","text":"Let X genotype--environment matrix. Let Singular Value Decomposition X = USV'. Let NIPALS decomposition X = TLP'. DANGER, algorithms factor L T.","code":"library(agridat) library(reshape2) library(nipals) dat3 <- agridat::yan.winterwheat dat3 <- acast(dat3, gen~env, value.var=\"yield\") dat3 <- scale(dat3, center=TRUE, scale=FALSE) Xsvd <- svd(dat3) Xnip <- nipals(dat3, center=FALSE, scale=FALSE) U <- Xsvd$u S <- diag(Xsvd$d) V <- Xsvd$v T <- Xnip$scores Lam <- diag(Xnip$eig) P <- Xnip$loadings"},{"path":"http://kwstat.github.io/gge/articles/gge_examples.html","id":"biplots-with-genotype-focus","dir":"Articles","previous_headings":"How to modify the “focus” of a biplot","what":"Biplots with genotype focus","title":"Genotype plus Genotype-By-Block-of-Environments Biplots","text":"obtain genotype-focused biplot eigenvalues associated U. genotype coordinates can obtained SVD using first two columns U*S equivalently NIPALS T*Lam. environment coordinates first two columns V (SVD) P (NIPALS).","code":"(U %*% S)[ , 1:2] (T %*% Lam)[ , 1:2] V[ , 1:2] P[ , 1:2]"},{"path":"http://kwstat.github.io/gge/articles/gge_examples.html","id":"biplot-with-environment-focus","dir":"Articles","previous_headings":"How to modify the “focus” of a biplot","what":"Biplot with environment focus","title":"Genotype plus Genotype-By-Block-of-Environments Biplots","text":"obtain environment-focused biplot eigenvalues associated V. genotype coordinates first two columns U (SVD) T (NIPALS). environment coordinates S*V (SVD) Lam*P (NIPALS).","code":"U[ , 1:2] T[ , 1:2] (S %*% V)[ , 1:2] (Lam %*% P)[ , 1:2]"},{"path":"http://kwstat.github.io/gge/articles/gge_examples.html","id":"comments-on-biplots","dir":"Articles","previous_headings":"How to modify the “focus” of a biplot","what":"Comments on biplots","title":"Genotype plus Genotype-By-Block-of-Environments Biplots","text":"Note GGE biplots environment-focused. particular, provides interpretation correlation genotype performance two environments approximated cosine angle vectors two environments. SVD NIPALS methods provide principal components complete-data, except principal component SVD corresponding principal component NIPALS might point opposite directions (differ factor -1 examples . corresponding biplots therefore mirror-reversed along component. biplots SVD NIPALS visually consistent, principal component can directed point direction positively correlated overall genotype means. words, correlation genotype means ordinate genotypes along principal component negative, principal component multiplied -1. biplots, environment vectors can arbitrarily scaled genotypes environments uses similar amount area plot. algorithm physically centers biplot scales page perfect opportunities improvement.","code":""},{"path":[]},{"path":"http://kwstat.github.io/gge/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Kevin Wright. Author, maintainer, copyright holder. Jean-Louis Laffont. Author.","code":""},{"path":"http://kwstat.github.io/gge/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Wright K, Laffont J (2024). gge: Genotype Plus Genotype--Environment Biplots. R package version 1.9, http://kwstat.github.io/gge/, https://kwstat.github.io/gge/.","code":"@Manual{,   title = {gge: Genotype Plus Genotype-by-Environment Biplots},   author = {Kevin Wright and Jean-Louis Laffont},   year = {2024},   note = {R package version 1.9, http://kwstat.github.io/gge/},   url = {https://kwstat.github.io/gge/}, }"},{"path":"http://kwstat.github.io/gge/index.html","id":"gge-","dir":"","previous_headings":"","what":"Genotype Plus Genotype-by-Environment Biplots","title":"Genotype Plus Genotype-by-Environment Biplots","text":"Homepage: https://kwstat.github.io/gge Repository: https://github.com/kwstat/gge Functions GGE (genotype plus genotype--environment) GGB (genotype plus genotype--block--environments) biplots.","code":""},{"path":"http://kwstat.github.io/gge/index.html","id":"key-features","dir":"","previous_headings":"","what":"Key features","title":"Genotype Plus Genotype-by-Environment Biplots","text":"Stable, well-tested. Many options control graphic appearance.","code":""},{"path":"http://kwstat.github.io/gge/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Genotype Plus Genotype-by-Environment Biplots","text":"","code":"# Install the released version from CRAN: install.packages(\"gge\")  # Install the development version from GitHub: install.packages(\"devtools\") devtools::install_github(\"kwstat/gge\")"},{"path":"http://kwstat.github.io/gge/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Genotype Plus Genotype-by-Environment Biplots","text":"example GGE biplot , genotypes shown green labels environments shown blue/gold labels. color determines mega-environment block--environments. thick, solid line drawn origin ‘average’ environments within block, thinner line drawn average individual environments. ‘residual’ vectors show deviations within group. dashed line extends edge plotting window labels group.","code":""},{"path":"http://kwstat.github.io/gge/reference/RedGrayBlue.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to create a Red-Gray-Blue palette — RedGrayBlue","title":"Function to create a Red-Gray-Blue palette — RedGrayBlue","text":"function create Red-Gray-Blue palette.","code":""},{"path":"http://kwstat.github.io/gge/reference/RedGrayBlue.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to create a Red-Gray-Blue palette — RedGrayBlue","text":"","code":"RedGrayBlue(n)"},{"path":"http://kwstat.github.io/gge/reference/RedGrayBlue.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to create a Red-Gray-Blue palette — RedGrayBlue","text":"n Number colors create","code":""},{"path":"http://kwstat.github.io/gge/reference/RedGrayBlue.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to create a Red-Gray-Blue palette — RedGrayBlue","text":"vector n colors.","code":""},{"path":"http://kwstat.github.io/gge/reference/RedGrayBlue.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Function to create a Red-Gray-Blue palette — RedGrayBlue","text":"Using gray instead white allows missing values appear white (actually, transparent).","code":""},{"path":"http://kwstat.github.io/gge/reference/RedGrayBlue.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Function to create a Red-Gray-Blue palette — RedGrayBlue","text":"Kevin Wright","code":""},{"path":"http://kwstat.github.io/gge/reference/RedGrayBlue.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Function to create a Red-Gray-Blue palette — RedGrayBlue","text":"","code":"pie(rep(1,11), col=RedGrayBlue(11)) title(\"RedGrayBlue(11)\")"},{"path":"http://kwstat.github.io/gge/reference/gge.html","id":null,"dir":"Reference","previous_headings":"","what":"GGE and GGB biplots — gge","title":"GGE and GGB biplots — gge","text":"Fit GGE (genotype + genotype * environment) model display results.","code":""},{"path":"http://kwstat.github.io/gge/reference/gge.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"GGE and GGB biplots — gge","text":"","code":"gge(x, ...)  # S3 method for class 'data.frame' gge(x, formula, gen.group = NULL, env.group = NULL, ggb = FALSE, ...)  # S3 method for class 'formula' gge(formula, data, gen.group = NULL, env.group = NULL, ggb = FALSE, ...)  # S3 method for class 'matrix' gge(   x,   center = TRUE,   scale = TRUE,   gen.group = NULL,   env.group = NULL,   ggb = FALSE,   comps = c(1, 2),   method = \"svd\",   ... )  # S3 method for class 'gge' plot(x, main = substitute(x), ...)  # S3 method for class 'gge' biplot(   x,   main = substitute(x),   subtitle = \"\",   xlab = \"auto\",   ylab = \"auto\",   cex.gen = 0.6,   cex.env = 0.5,   col.gen = \"darkgreen\",   col.env = \"orange3\",   pch.gen = 1,   lab.env = TRUE,   comps = 1:2,   flip = \"auto\",   origin = \"auto\",   res.vec = TRUE,   hull = FALSE,   zoom.gen = 1,   zoom.env = 1,   ... )  biplot3d(x, ...)  # S3 method for class 'gge' biplot3d(   x,   cex.gen = 0.6,   cex.env = 0.5,   col.gen = \"darkgreen\",   col.env = \"orange3\",   comps = 1:3,   lab.env = TRUE,   res.vec = TRUE,   zoom.gen = 1,   ... )"},{"path":"http://kwstat.github.io/gge/reference/gge.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"GGE and GGB biplots — gge","text":"x matrix data.frame. ... arguments (e.g. maxiter, gramschmidt) formula formula gen.group genotype group env.group env group ggb TRUE, fit GGB biplot model. data Data frame center TRUE, center values environment scale TRUE, scale values environment comps Principal components use biplot. Default c(1,2). method method used find principal component directions. Either \"svd\" \"nipals\". main Title, default name data. Use NULL suppress title. subtitle Subtitle put front options. Use NULL suppress subtitle. xlab Label along axis. Default \"auto\" shows percent variation explained. Use NULL suppress. ylab Label along axis. Default \"auto\" shows percent variation explained. Use NULL suppress. cex.gen Character expansion genotype labels, default 0.6. Use 0 omit genotype labels. cex.env Character expansion environment labels/symbols.  Use lab.env=FALSE omit labels. col.gen Color genotype labels.  May single color genotypes, vector colors genotype. col.env Color environments. May single color environments, vector colors environment. pch.gen Plot character genotypes lab.env Label environments TRUE. flip \"auto\" axis flipped genotype ordinate positively correlated genotype means.  Can also vector like c(TRUE,FALSE) manual control. origin \"auto\", plotting window centered genotypes, otherwise origin middle window. res.vec TRUE, group, draw residual vectors mean locs individual locs. hull TRUE, show -won-polygon. zoom.gen Zoom factor manual control genotype xlim,ylim default 1. Values less 1 may useful genotype names long. zoom.env Zoom factor manual control environment xlim,ylim. default 1. Values less 1 may useful environment names long. used 3D biplots.","code":""},{"path":"http://kwstat.github.io/gge/reference/gge.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"GGE and GGB biplots — gge","text":"list class gge containing: x filled-data x.orig original data genCoord genotype coordinates locCoord loc coordinates blockCoord block coordinates gen.group NULL, use specify column   data.frame classify genotypes groups. env.group NULL, use specify column   data.frame classify environments groups. ggb TRUE, create GGB biplot genMeans genotype means mosdat mosaic plot data R2 variation explained PC center Data centered? scale Data scaled? method Method used calculate principal components. pctMiss Percent x missing values maxPCs Maximum number PCs","code":""},{"path":"http://kwstat.github.io/gge/reference/gge.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"GGE and GGB biplots — gge","text":"replication G*E, replications averaged together constructing biplot. singular value decomposition x used calculate principal components biplot.  Missing values allowed. argument method can either 'svd' complete-data 'nipals' missing-data.","code":""},{"path":"http://kwstat.github.io/gge/reference/gge.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"GGE and GGB biplots — gge","text":"Jean-Louis Laffont, Kevin Wright Mohamed Hanafi (2013). Genotype + Genotype x Block Environments (GGB) Biplots. Crop Science, 53, 2332-2341. doi:10.2135/cropsci2013.03.0178 . Kroonenberg, Pieter M. (1997). Introduction Biplots GxE Tables, Research Report 51, Centre Statistics, University Queensland, Brisbane, Australia. https://three-mode.leidenuniv.nl/document/biplot.pdf Yan, W. Kang, M.S. (2003). GGE Biplot Analysis.  CRC Press.","code":""},{"path":"http://kwstat.github.io/gge/reference/gge.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"GGE and GGB biplots — gge","text":"Kevin Wright, Jean-Louis Laffont Jean-Louis Laffont, Kevin Wright","code":""},{"path":"http://kwstat.github.io/gge/reference/gge.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"GGE and GGB biplots — gge","text":"","code":"# Example 1.  Data is a data.frame in 'matrix' format B <- matrix(c(50, 67, 90, 98, 120,               55, 71, 93, 102, 129,               65, 76, 95, 105, 134,               50, 80, 102, 130, 138,               60, 82, 97, 135, 151,               65, 89, 106, 137, 153,               75, 95, 117, 133, 155), ncol=5, byrow=TRUE) rownames(B) <- c(\"G1\",\"G2\",\"G3\",\"G4\",\"G5\",\"G6\",\"G7\") colnames(B) <- c(\"E1\",\"E2\",\"E3\",\"E4\",\"E5\")  library(gge) m1 = gge(B) plot(m1)  biplot(m1, main=\"Example biplot\")  # biplot3d(m1)  if(require(agridat)){   # crossa.wheat biplot    # Specify env.group as column in data frame   data(crossa.wheat)   dat2 <- crossa.wheat   m2 <- gge(dat2, yield~gen*loc, env.group=locgroup, scale=FALSE)   plot(m2)   biplot(m2, lab.env=TRUE, main=\"crossa.wheat\")   # biplot3d(m2) } #> Loading required package: agridat"},{"path":"http://kwstat.github.io/gge/news/index.html","id":"gge-19-20241028","dir":"Changelog","previous_headings":"","what":"gge 1.9 (2024.10.28)","title":"gge 1.9 (2024.10.28)","text":"Documentation pages now created via Github Actions. Changed vignette chunk option eval=0 eval=FALSE maybe fix error revdep-checking agridat. Fixed vignette example showing difference genotype-focused environment-focused biplots.","code":""},{"path":"http://kwstat.github.io/gge/news/index.html","id":"gge-18-2023-08-20","dir":"Changelog","previous_headings":"","what":"gge 1.8 (2023-08-20)","title":"gge 1.8 (2023-08-20)","text":"CRAN release: 2023-08-21 Switch GPL3 MIT license. Fix docType issue requested CRAN.","code":""},{"path":"http://kwstat.github.io/gge/news/index.html","id":"gge-17-2021-10-31","dir":"Changelog","previous_headings":"","what":"gge 1.7 (2021-10-31)","title":"gge 1.7 (2021-10-31)","text":"CRAN release: 2021-10-31 Remove LazyData DESCRIPTION.","code":""},{"path":"http://kwstat.github.io/gge/news/index.html","id":"gge-16-2020-12-16","dir":"Changelog","previous_headings":"","what":"gge 1.6 (2020-12-16)","title":"gge 1.6 (2020-12-16)","text":"CRAN release: 2020-12-16 Brian Ripley wrote: “future OpenGL uncertain (except macOS, future). seems reasonable require rgl essential package. packages Depends/Imports seem actually call checks (established using fake install). possible sole purpose package might interactive visualizations checked, seems case . noticed calls rgl functions , better conditioned (interactive()) (see ‘Writing R Extensions’). Please move rgl Suggests use conditionally (see §1.1.3.1 ‘Writing R Extensions’) next package update.”” Moved rgl Suggests. use require(rgl) crashes R users, use (\"rgl\" %% installed.packages() ) check installation call functions rgl::open3d()","code":""},{"path":"http://kwstat.github.io/gge/news/index.html","id":"gge-15-2020-07-21","dir":"Changelog","previous_headings":"","what":"gge 1.5 (2020-07-21)","title":"gge 1.5 (2020-07-21)","text":"CRAN release: 2020-07-21 Please use gge(data,formula) instead gge(formula,data). New argument ggb=TRUE request construction GGB biplot.","code":""},{"path":"http://kwstat.github.io/gge/news/index.html","id":"gge-14-2018-05-15","dir":"Changelog","previous_headings":"","what":"gge 1.4 (2018-05-15)","title":"gge 1.4 (2018-05-15)","text":"CRAN release: 2018-05-15 Use cex.gen=0 omit genotype names. Windows machines, library(rgl) crashes R, perhaps dll conflict Windows. Removed @import rgl rgl loaded default, now biplot3d uses calls like rgl::text3d.","code":""},{"path":"http://kwstat.github.io/gge/news/index.html","id":"gge-13-2017-12-14","dir":"Changelog","previous_headings":"","what":"gge 1.3 (2017-12-14)","title":"gge 1.3 (2017-12-14)","text":"CRAN release: 2017-12-14 nipals() function using C++ code removed. rnipals() function removed. gge package now imports nipals package, new.","code":""},{"path":"http://kwstat.github.io/gge/news/index.html","id":"gge-12---2017-05-26","dir":"Changelog","previous_headings":"","what":"gge 1.2 - (2017-05-26)","title":"gge 1.2 - (2017-05-26)","text":"CRAN release: 2017-05-25 New function nipals() finding principal components using C++. Code pcaMethods package. New function rnipals() finding principal components R. New function biplot3d() draw 3d biplots using rgl package. Modifed main, subtitle, xlab, ylab arguments allow removal. Changed title argument main consistency packages. Now using testthat covr packages. Added package logo GitHub.","code":""},{"path":"http://kwstat.github.io/gge/news/index.html","id":"gge-11-2016-10-08","dir":"Changelog","previous_headings":"","what":"gge 1.1 (2016-10-08)","title":"gge 1.1 (2016-10-08)","text":"CRAN release: 2016-10-08 Added zoom.gen zoom.env arguments biplot() M.Zoric. Moved tests tests/gge_tests.R","code":""},{"path":"http://kwstat.github.io/gge/news/index.html","id":"gge-10-2015-12-14","dir":"Changelog","previous_headings":"","what":"gge 1.0 (2015-12-14)","title":"gge 1.0 (2015-12-14)","text":"CRAN release: 2015-12-14 Package gge split agridat package. Added origin, hull arguments biplot().","code":""},{"path":"http://kwstat.github.io/gge/news/index.html","id":"gge-01---2013-01-01","dir":"Changelog","previous_headings":"","what":"gge 0.1 - (2013-01-01)","title":"gge 0.1 - (2013-01-01)","text":"Added gge() agridat package.","code":""},{"path":"http://kwstat.github.io/gge/news/index.html","id":"gge-00---2004-01-01","dir":"Changelog","previous_headings":"","what":"gge 0.0 - (2004-01-01)","title":"gge 0.0 - (2004-01-01)","text":"Created function gge() fit plot GGE biplots.","code":""},{"path":"http://kwstat.github.io/gge/news/index.html","id":"a-history-of-nipals-functions-in-gge-0-0","dir":"Changelog","previous_headings":"","what":"A history of NIPALS functions in gge","title":"gge 0.0 - (2004-01-01)","text":"Created nipals() based pcaMethods::nipalsPca(). Modified function faster execution submitted patch back pcaMethods. Henning Redestig created C++ version NIPALS pcaMethods package. gge::nipals() R function re-named rnipals(), new nipals() function created, based C++ code pcaMethods. Released gge version 1.2. Discovered mixOmics::nipals() pure R function faster C++ version, gge::nipals() re-written pure R function. C++ version removed gge package. gge::nipals function moved new package, nipals::nipals. function optimized performance, improved better handle missing values orthogonalize principal components.","code":""}]
